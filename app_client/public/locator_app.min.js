!function(){function t(t,o){t.when("/",{templateUrl:"components/home.view.html",controller:"homeCtrl"}).when("/addlocation",{templateUrl:"components/addLocation.view.html",controller:"addLocationCtrl",controllerAs:"vm"}).when("/locations/type/:type",{templateUrl:"components/location_types/locationType.view.html",controller:"locationTypeCtrl"}).when("/location/:locationid",{templateUrl:"components/locationDetail.view.html",controller:"locationDetailCtrl",controllerAs:"vm"}).when("/about",{templateUrl:"components/common/aboutPage.view.html"}).when("/register",{templateUrl:"components/auth/register.view.html",controller:"registerCtrl",controllerAs:"vm"}).when("/login",{templateUrl:"components/auth/login.view.html",controller:"loginCtrl",controllerAs:"vm"}).when("/notfound",{templateUrl:"components/common/notfound.view.html"}).otherwise({redirectTo:"/notfound"}),o.html5Mode(!0)}angular.module("locator_app",["ngRoute"]),t.$inject=["$routeProvider","$locationProvider"],angular.module("locator_app").config(["$routeProvider","$locationProvider",t])}(),function(){angular.module("locator_app").controller("homeCtrl",function(){})}(),function(){function t(t){let o=this;o.openingTimes=[],o.pushDefaultOpeningTime=(()=>{o.openingTimes.push({day:null,state:!1,open:null,close:null})}),o.onSubmit=(()=>{let e=o.formData;if(!(e&&e.name&&e.type&&e.address&&e.rating&&e.longitude&&e.latitude&&e.discount&&e.imageLink&&0!=o.openingTimes.length))return void alert("All fields are required!");let n=[];if(o.formData.checkboxFood&&n.push("Food"),o.formData.checkboxSilence&&n.push("Silence"),o.formData.checkboxWifi&&n.push("Wifi"),o.formData.checkboxOutdoor&&n.push("Outdoor"),o.formData.checkboxDrink&&n.push("Drinks"),o.formData.checkboxGaming&&n.push("Game"),o.formData.checkboxOvernight&&n.push("Overnight"),o.formData.checkboxPower&&n.push("Power"),0==n.length)return void alert("Please choose at least one keyword");let r=!0;o.openingTimes.forEach(t=>{if(1==t.state)for(let o in t)null==t[o]&&(r=!1);else t.day?(t.close="",t.open=""):r=!1}),r?t.post("/api/locations/addlocation",{name:e.name,type:e.type,keywords:n,address:e.address,rating:e.rating,longitude:e.longitude,latitude:e.latitude,discount:e.discount,imageLink:e.imageLink,openingTimes:o.openingTimes}).then(t=>{alert(t.data.msg)},t=>{throw new Error(t)}):alert("All fields are required!")})}angular.module("locator_app").controller("addLocationCtrl",t),t.$inject=["$http"]}(),function(){function t(t,o,e){let n=this,r=t.locationid;o.get("/api/locations/"+r).then(function(t){n.data=t.data.data},function(t){console.log(t)})}angular.module("locator_app").controller("locationDetailCtrl",t),t.$inject=["$routeParams","$http","$scope"]}(),function(){function t(t,o,e){t.type=e.type;o.get(`/api/locations/type/${e.type}`).then(function(o){t.locations=o.data.data},function(t){console.log(t)})}angular.module("locator_app").controller("locationTypeCtrl",t),t.$inject=["$scope","$http","$routeParams"]}(),function(){angular.module("locator_app").directive("navigation",function(){return{restrict:"EA",templateUrl:"components/common/navigation.template.html",controller:"navigationCtrl as navvm"}})}(),function(){angular.module("locator_app").directive("myfooter",function(){return{restrict:"EA",templateUrl:"components/common/myfooter.template.html"}})}(),function(){angular.module("locator_app").directive("ratingStars",function(){return{restrict:"EA",scope:{thisRating:"=rating"},templateUrl:"components/common/ratingStars.template.html"}})}(),function(){function t(t,o){var e=this;e.currentPath=t.path(),e.isLoggedIn=o.isLoggedIn(),e.currentUser=o.currentUser(),e.logout=function(){o.logout(),t.path("/")}}angular.module("locator_app").controller("navigationCtrl",t),t.$inject=["$location","authentication"]}(),function(){function t(t,o,e){var n=this;n.credentials={email:"",password:""},n.returnPage=t.search().page||"/",n.onSubmit=function(){n.formError="",n.credentials.email&&n.credentials.password?n.doLogin():n.formError="All fields required, please try again!"},n.doLogin=function(){n.formError="",e.login(n.credentials).then(o=>{e.saveToken(o.data.data.jwt),t.path(n.returnPage)},t=>{n.formError=t.data.msg})}}angular.module("locator_app").controller("loginCtrl",t),t.$inject=["$location","$http","authentication"]}(),function(){function t(t,o,e){var n=this;n.credentials={name:"",email:"",password:""},n.returnPage=t.search().page||"/login",n.onSubmit=function(){n.formError="",n.credentials.name&&n.credentials.email&&n.password1&&n.password2?n.password1===n.password2?(n.credentials.password=n.password1,n.doRegister()):n.formError="Your password does not match, please try again!":n.formError="All fields required, please try again!"},n.doRegister=function(){n.formError="",e.register(n.credentials).then(o=>{alert("Register successful!"),t.path(n.returnPage)},t=>{n.formError=t.data.msg})}}angular.module("locator_app").controller("registerCtrl",t),t.$inject=["$location","$http","authentication"]}(),function(){function t(t,o){var e=function(){return o.localStorage["locator_app-token"]},n=function(){var t=e();return!!t&&JSON.parse(o.atob(t.split(".")[1])).exp>Date.now()/1e3};return{saveToken:function(t){o.localStorage["locator_app-token"]=t},getToken:e,register:function(o,e){return t.post("/api/register",o)},login:function(o,e){return t.post("/api/login",o)},logout:function(){o.localStorage.removeItem("locator_app-token")},isLoggedIn:n,currentUser:function(){if(n()){var t=e(),r=JSON.parse(o.atob(t.split(".")[1]));return{email:r.email,name:r.name}}}}}angular.module("locator_app").service("authentication",t),t.$inject=["$http","$window"]}();